[
  {
    "objectID": "quarto_scripts/summary_rodriguez.html",
    "href": "quarto_scripts/summary_rodriguez.html",
    "title": "Results Summary: Rodriguez Augmentation Methods",
    "section": "",
    "text": "Use the controls to explore how Rodriguez augmentation strategies compare with their benchmarks in terms of the mean performance metric. You can choose among three performance metrics and four augmentation factors. Results are shown for experiments using data with a pseudo-count of \\(\\mathbf{1/2}\\).\n\n\n\n\n\n\nPerformance metric\n\n\n\n\n\n\n\n\nAugmentation factor\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nk = 2k = 3k = 4k = 5\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nk = 2k = 3k = 4k = 5\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nk = 2k = 3k = 4k = 5\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nk = 1k = 2k = 3k = 4k = 5k = 6k = 7k = 8k = 9k = 10k = 11k = 12\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTODO: why summary for RF is not rendering????\n\n\n\n\n\n\nPerformance metric\n\n\n\n\n\n\n\n\nAugmentation factor"
  },
  {
    "objectID": "quarto_scripts/summary_rodriguez.html#lasso---pseudo-count-12",
    "href": "quarto_scripts/summary_rodriguez.html#lasso---pseudo-count-12",
    "title": "Results Summary: Rodriguez Augmentation Methods",
    "section": "",
    "text": "Use the controls to explore how Rodriguez augmentation strategies compare with their benchmarks in terms of the mean performance metric. You can choose among three performance metrics and four augmentation factors. Results are shown for experiments using data with a pseudo-count of \\(\\mathbf{1/2}\\).\n\n\n\n\n\n\nPerformance metric\n\n\n\n\n\n\n\n\nAugmentation factor\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nk = 2k = 3k = 4k = 5\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nk = 2k = 3k = 4k = 5\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nk = 2k = 3k = 4k = 5\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nk = 1k = 2k = 3k = 4k = 5k = 6k = 7k = 8k = 9k = 10k = 11k = 12\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTODO: why summary for RF is not rendering????\n\n\n\n\n\n\nPerformance metric\n\n\n\n\n\n\n\n\nAugmentation factor"
  },
  {
    "objectID": "quarto_scripts/summary_rodriguez.html#rf---pseudo-count-12",
    "href": "quarto_scripts/summary_rodriguez.html#rf---pseudo-count-12",
    "title": "Results Summary: Rodriguez Augmentation Methods",
    "section": "",
    "text": "TODO: why summary for RF is not rendering????\n\n\n\n\n\n\nPerformance metric\n\n\n\n\n\n\n\n\nAugmentation factor"
  },
  {
    "objectID": "quarto_scripts/density_impact.html",
    "href": "quarto_scripts/density_impact.html",
    "title": "Density Impact",
    "section": "",
    "text": "The purpose of this document is to show the influence of the density of a skew-symmetric matrix used for a generation of a GHL matrix used in the random ILR augmentation methods.\nReminder: Density \\(\\delta=0.1\\) means that \\(10\\%\\) of the off-diagonal entries in the skew-symmetric matrix \\(S\\) are non-zero; each such non-zero value is drawn from a standard normal distribution (\\(s_{ij}\\sim\\mathcal{N}(0,1)\\)) and \\(s_{ji}=-s_{ij}\\). The default density refers to the very sparse case in which exactly one off-diagonal element in the lower triangle and its mirror element in the upper triangle are non-zero; all other off-diagonal entries are zero.\nTo understand the impact of density of skew-symmetric matrix on the GHL matrix, and in consequence on the random ilr transformation, one needs to understand first in terms of the formulas how is the GHL matrix used in the random ilr transformation. In order to achieve it, let’s have a look on the below example with the use of the four dimensional compositional vector \\(\\mathbf{x},\\, \\mathbf{x} \\in S^4\\):\n\\[\n\\mathbf{x} \\in S^{4}, \\; \\mathbf{x}=\\bigl[\\,x_{1},\\,x_{2},\\,x_{3},\\,x_{4}\\,\\bigr]\n\\]\n\\[\n\\mathrm{ilr}(x)=\\mathrm{clr}(x)\\,\\mathrm{L}_{-1}=\\bigl[\\,y_{1},\\,y_{2},\\,y_{3}\\,\\bigr],\n\\]\nwhere \\(L_{-1}\\) is the GHL matrix without last column and \\(dim\\bigl(L_{-1}\\bigr) = 4 \\times 3\\). The centered log-ratio transformation is given by:\n\\[\n\\mathrm{clr}(x)=\\Bigl[\\,\\ln\\frac{x_{1}}{g(x)},\\,\\ln\\frac{x_{2}}{g(x)},\\,\\ln\\frac{x_{3}}{g(x)},\\,\\ln\\frac{x_{4}}{g(x)}\\,\\Bigr],\n\\]\nwhere \\(g(x)\\) is a geometric mean of the entries of a vector \\(\\mathbf{x}\\) . Let’s represent the GHL matrix with the removed last column as follows:\n\\[\nL_{-1} = \\begin{bmatrix}a_{1} & b_{1} & c_{1} \\\\a_{2} & b_{2} & c_{2} \\\\a_{3} & b_{3} & c_{3} \\\\a_{4} & b_{4} & c_{4}\\end{bmatrix}\n\\]\n\\[\n\\begin{aligned}\\mathrm{ilr}(x)&=\\mathrm{clr}(x)\\,\\mathrm{L}_{-1} \\\\\n&=\\Bigl[\\,a_{1}\\ln\\frac{x_{1}}{g(x)}+a_{2}\\ln\\frac{x_{2}}{g(x)}+a_{3}\\ln\\frac{x_{3}}{g(x)}+a_{4}\\ln\\frac{x_{4}}{g(x)},\\;\\\\ & \\,b_{1}\\ln\\frac{x_{1}}{g(x)}+b_{2}\\ln\\frac{x_{2}}{g(x)}+b_{3}\\ln\\frac{x_{3}}{g(x)}+b_{4}\\ln\\frac{x_{4}}{g(x)}, \\;\\\\\n& \\,c_{1}\\ln\\frac{x_{1}}{g(x)}+c_{2}\\ln\\frac{x_{2}}{g(x)}+c_{3}\\ln\\frac{x_{3}}{g(x)}+c_{4}\\ln\\frac{x_{4}}{g(x)},\n\\Bigr] \\\\\n&=\\Biggl[\\,\\ln\\frac{x_{1}^{a_{1}}x_{2}^{a_{2}}x_{3}^{a_{3}}x_{4}^{a_{4}}}{\\bigl[g(x)\\bigr]^{a_{1}+a_{2}+a_{3}+a_{4}}},\\; \\ln\\frac{x_{1}^{b_{1}}x_{2}^{b_{2}}x_{3}^{b_{3}}x_{4}^{b_{4}}}{\\bigl[g(x)\\bigr]^{b_{1}+b_{2}+b_{3}+b_{4}}},\\;\n\\ln\\frac{x_{1}^{c_{1}}x_{2}^{c_{2}}x_{3}^{c_{3}}x_{4}^{c_{4}}}{\\bigl[g(x)\\bigr]^{c_{1}+c_{2}+c_{3}+c_{4}}}\n\\Biggr] \\\\\n&= \\Bigl[\\,\\ln\\!\\bigl(x_{1}^{a_{1}}x_{2}^{a_{2}}x_{3}^{a_{3}}x_{4}^{a_{4}}\\bigr),\\;\n\\ln\\!\\bigl(x_{1}^{b_{1}}x_{2}^{b_{2}}x_{3}^{b_{3}}x_{4}^{b_{4}}\\bigr),\\;\n\\ln\\!\\bigl(x_{1}^{c_{1}}x_{2}^{c_{2}}x_{3}^{c_{3}}x_{4}^{c_{4}}\\bigr)\n\\Bigr]\n\\end{aligned}\n\\]\nThe last equality in the above representation of the random ilr transformation is the consequence of the following property of GHL matrix under consideration:\n\\[\n\\mathbf{1}_{n}^{\\mathsf T}L_{n,n-1}=\\mathbf{0}_{n-1}^{\\mathsf T}\n\\]\ntherefore: \\(a_{1}+a_{2}+a_{3}+a_{4}=0\\). Similarly for \\(b_{i}, c_{i}, i \\in \\{1,2,3,4\\}\\). Therefore, the contribution of a original feature \\(x_i\\) to the new coordinate after random ilr transformation (\\(y_i\\)) depends on the sign of coefficients from GHL matrix \\(a_i, b_i, c_i, i \\in \\{1, \\dots, 4\\}\\). For instance, in the considered example of \\(\\mathbf{x}, \\, \\mathbf{x} \\in S^4\\) let’s focus on the first coordinate resulting from the random ilr transformation. Let’s assume that \\(a_1, a_3 &gt; 0\\) and \\(a_2, a_4 &lt;0\\). Then, the new first ilr coordinate has the following form:\n\\[\ny_{1}=\\ln\\!\\left(\\frac{x_{1}^{a_{1}}\\,x_{3}^{a_{3}}}{x_{2}^{a_{2}}\\,x_{4}^{a_{4}}}\\right)\n\\]\nIn such a case original features \\(x_1, x_3\\) contribute to the new coordinate in the numerator, while covariates \\(x_2, x_4\\) contribute to the \\(y_1\\) in the denominator.\nThe strength of the contribution of a given original feature to the new random ilr coordinate depends on the absolute value of the coefficient from the GHL matrix. For example, the contribution of \\(x_1\\) to ilr coordinate \\(y_1\\) depends on the \\(|a_1|\\). In the below analysis term top k contributor will be used.\nTop k contributor: Feature \\(x_j\\) coming from compositional vector \\(\\mathbf{x}, \\, \\mathbf{x} \\in S^p\\) is considered as the top \\(k\\) contributor to the new ilr coordinate \\(y_i, \\, y_i = \\ln\\!\\bigl(x_{1}^{w_{1}}x_{2}^{w_{2}} \\dots x_{p}^{w_{p}}\\bigr) \\; \\text{where} \\; \\mathbf{y} = \\bigl(y_1, y_2, \\dots, y_{p-1} \\bigr)\\) when the absolute value of the coefficient from GHL matrix associated with \\(x_j\\) ranks within top \\(k\\) largest absolute coefficients \\(|w_1|, |w_2|, \\dots, |w_p|\\)."
  },
  {
    "objectID": "quarto_scripts/density_impact.html#theoretical-overview",
    "href": "quarto_scripts/density_impact.html#theoretical-overview",
    "title": "Density Impact",
    "section": "",
    "text": "The purpose of this document is to show the influence of the density of a skew-symmetric matrix used for a generation of a GHL matrix used in the random ILR augmentation methods.\nReminder: Density \\(\\delta=0.1\\) means that \\(10\\%\\) of the off-diagonal entries in the skew-symmetric matrix \\(S\\) are non-zero; each such non-zero value is drawn from a standard normal distribution (\\(s_{ij}\\sim\\mathcal{N}(0,1)\\)) and \\(s_{ji}=-s_{ij}\\). The default density refers to the very sparse case in which exactly one off-diagonal element in the lower triangle and its mirror element in the upper triangle are non-zero; all other off-diagonal entries are zero.\nTo understand the impact of density of skew-symmetric matrix on the GHL matrix, and in consequence on the random ilr transformation, one needs to understand first in terms of the formulas how is the GHL matrix used in the random ilr transformation. In order to achieve it, let’s have a look on the below example with the use of the four dimensional compositional vector \\(\\mathbf{x},\\, \\mathbf{x} \\in S^4\\):\n\\[\n\\mathbf{x} \\in S^{4}, \\; \\mathbf{x}=\\bigl[\\,x_{1},\\,x_{2},\\,x_{3},\\,x_{4}\\,\\bigr]\n\\]\n\\[\n\\mathrm{ilr}(x)=\\mathrm{clr}(x)\\,\\mathrm{L}_{-1}=\\bigl[\\,y_{1},\\,y_{2},\\,y_{3}\\,\\bigr],\n\\]\nwhere \\(L_{-1}\\) is the GHL matrix without last column and \\(dim\\bigl(L_{-1}\\bigr) = 4 \\times 3\\). The centered log-ratio transformation is given by:\n\\[\n\\mathrm{clr}(x)=\\Bigl[\\,\\ln\\frac{x_{1}}{g(x)},\\,\\ln\\frac{x_{2}}{g(x)},\\,\\ln\\frac{x_{3}}{g(x)},\\,\\ln\\frac{x_{4}}{g(x)}\\,\\Bigr],\n\\]\nwhere \\(g(x)\\) is a geometric mean of the entries of a vector \\(\\mathbf{x}\\) . Let’s represent the GHL matrix with the removed last column as follows:\n\\[\nL_{-1} = \\begin{bmatrix}a_{1} & b_{1} & c_{1} \\\\a_{2} & b_{2} & c_{2} \\\\a_{3} & b_{3} & c_{3} \\\\a_{4} & b_{4} & c_{4}\\end{bmatrix}\n\\]\n\\[\n\\begin{aligned}\\mathrm{ilr}(x)&=\\mathrm{clr}(x)\\,\\mathrm{L}_{-1} \\\\\n&=\\Bigl[\\,a_{1}\\ln\\frac{x_{1}}{g(x)}+a_{2}\\ln\\frac{x_{2}}{g(x)}+a_{3}\\ln\\frac{x_{3}}{g(x)}+a_{4}\\ln\\frac{x_{4}}{g(x)},\\;\\\\ & \\,b_{1}\\ln\\frac{x_{1}}{g(x)}+b_{2}\\ln\\frac{x_{2}}{g(x)}+b_{3}\\ln\\frac{x_{3}}{g(x)}+b_{4}\\ln\\frac{x_{4}}{g(x)}, \\;\\\\\n& \\,c_{1}\\ln\\frac{x_{1}}{g(x)}+c_{2}\\ln\\frac{x_{2}}{g(x)}+c_{3}\\ln\\frac{x_{3}}{g(x)}+c_{4}\\ln\\frac{x_{4}}{g(x)},\n\\Bigr] \\\\\n&=\\Biggl[\\,\\ln\\frac{x_{1}^{a_{1}}x_{2}^{a_{2}}x_{3}^{a_{3}}x_{4}^{a_{4}}}{\\bigl[g(x)\\bigr]^{a_{1}+a_{2}+a_{3}+a_{4}}},\\; \\ln\\frac{x_{1}^{b_{1}}x_{2}^{b_{2}}x_{3}^{b_{3}}x_{4}^{b_{4}}}{\\bigl[g(x)\\bigr]^{b_{1}+b_{2}+b_{3}+b_{4}}},\\;\n\\ln\\frac{x_{1}^{c_{1}}x_{2}^{c_{2}}x_{3}^{c_{3}}x_{4}^{c_{4}}}{\\bigl[g(x)\\bigr]^{c_{1}+c_{2}+c_{3}+c_{4}}}\n\\Biggr] \\\\\n&= \\Bigl[\\,\\ln\\!\\bigl(x_{1}^{a_{1}}x_{2}^{a_{2}}x_{3}^{a_{3}}x_{4}^{a_{4}}\\bigr),\\;\n\\ln\\!\\bigl(x_{1}^{b_{1}}x_{2}^{b_{2}}x_{3}^{b_{3}}x_{4}^{b_{4}}\\bigr),\\;\n\\ln\\!\\bigl(x_{1}^{c_{1}}x_{2}^{c_{2}}x_{3}^{c_{3}}x_{4}^{c_{4}}\\bigr)\n\\Bigr]\n\\end{aligned}\n\\]\nThe last equality in the above representation of the random ilr transformation is the consequence of the following property of GHL matrix under consideration:\n\\[\n\\mathbf{1}_{n}^{\\mathsf T}L_{n,n-1}=\\mathbf{0}_{n-1}^{\\mathsf T}\n\\]\ntherefore: \\(a_{1}+a_{2}+a_{3}+a_{4}=0\\). Similarly for \\(b_{i}, c_{i}, i \\in \\{1,2,3,4\\}\\). Therefore, the contribution of a original feature \\(x_i\\) to the new coordinate after random ilr transformation (\\(y_i\\)) depends on the sign of coefficients from GHL matrix \\(a_i, b_i, c_i, i \\in \\{1, \\dots, 4\\}\\). For instance, in the considered example of \\(\\mathbf{x}, \\, \\mathbf{x} \\in S^4\\) let’s focus on the first coordinate resulting from the random ilr transformation. Let’s assume that \\(a_1, a_3 &gt; 0\\) and \\(a_2, a_4 &lt;0\\). Then, the new first ilr coordinate has the following form:\n\\[\ny_{1}=\\ln\\!\\left(\\frac{x_{1}^{a_{1}}\\,x_{3}^{a_{3}}}{x_{2}^{a_{2}}\\,x_{4}^{a_{4}}}\\right)\n\\]\nIn such a case original features \\(x_1, x_3\\) contribute to the new coordinate in the numerator, while covariates \\(x_2, x_4\\) contribute to the \\(y_1\\) in the denominator.\nThe strength of the contribution of a given original feature to the new random ilr coordinate depends on the absolute value of the coefficient from the GHL matrix. For example, the contribution of \\(x_1\\) to ilr coordinate \\(y_1\\) depends on the \\(|a_1|\\). In the below analysis term top k contributor will be used.\nTop k contributor: Feature \\(x_j\\) coming from compositional vector \\(\\mathbf{x}, \\, \\mathbf{x} \\in S^p\\) is considered as the top \\(k\\) contributor to the new ilr coordinate \\(y_i, \\, y_i = \\ln\\!\\bigl(x_{1}^{w_{1}}x_{2}^{w_{2}} \\dots x_{p}^{w_{p}}\\bigr) \\; \\text{where} \\; \\mathbf{y} = \\bigl(y_1, y_2, \\dots, y_{p-1} \\bigr)\\) when the absolute value of the coefficient from GHL matrix associated with \\(x_j\\) ranks within top \\(k\\) largest absolute coefficients \\(|w_1|, |w_2|, \\dots, |w_p|\\)."
  },
  {
    "objectID": "quarto_scripts/density_impact.html#analysis",
    "href": "quarto_scripts/density_impact.html#analysis",
    "title": "Density Impact",
    "section": "2 Analysis",
    "text": "2 Analysis\nHelper functions used in this script:\n\n\nCode\n# Function that takes the GHL matrix and:\n# 1. determines if original feature x_i contributes to the ilr coordinate in numerator or denominator\n# 2. determines top k contributors for each of the\nunderstand_randilr &lt;- function(ghl, org_feature_names, top_k) {\n    abs_ghl &lt;- abs(ghl)\n    sign_ghl &lt;- sign(ghl)\n\n    ghl_summary &lt;- map(c(1:ncol(ghl)), function(j) {\n        # Pull the j-th column\n        abs_col &lt;- abs_ghl[, j]\n        sign_col &lt;- sign_ghl[, j]\n        column &lt;- ghl[, j]\n\n        # Get names of the original features that go into numerator (have positive 'coefficient' in the GHL mat.):\n        pos &lt;- org_feature_names[sign_col == 1]\n        # Get names of the original features that go into denominator\n        neg &lt;- org_feature_names[sign_col == -1]\n\n        # top-k absolute contributors and the values of their coeffs (not absolute, just as is)\n        idx &lt;- order(abs_col, decreasing = TRUE)[1:top_k]\n        top_k_tbl &lt;- tibble(\n            feature = org_feature_names[idx],\n            coef    = column[idx]\n        )\n\n        # number of distinct absolute values of coeff\n        unique_coefs &lt;- length(unique(abs_col))\n\n        list(\n            column = j,\n            unique_coefs = unique_coefs,\n            numerator = pos,\n            denominator = neg,\n            top_k_contribution = top_k_tbl\n        )\n    })\n\n    # Return tibble\n    tibble(\n        column = map_dbl(ghl_summary, ~ .x$column),\n        unique_coefs = map_dbl(ghl_summary, ~ .x$unique_coefs),\n        numerator = map(ghl_summary, ~ .x$numerator),\n        denominator = map(ghl_summary, ~ .x$denominator),\n        top_contribution = map(ghl_summary, ~ .x$top_k_contribution)\n    )\n}\n\n# Function:\n# 1. Construct square GHL matrix with n_org_features rows and column by using skew-symmetric matrix with `density`\n# 2. Gathers info about contribution to numerator/denominator of each feature and top k contributors\n# 3. repeats 1-2 n_iters times\ndensity_impact &lt;- function(seed_start = 2025, n_org_features, density, top_k, n_iters = 10) {\n    set.seed(seed_start)\n    org_feature_names &lt;- paste0(\"org_feature\", c(1:n_org_features))\n    results &lt;- tibble()\n\n    for (i in 1:n_iters) {\n        # Generate GHL matrix\n        ghl &lt;- create_ghl(n = n_org_features, density = density)\n        ghl_mat &lt;- ghl[, -n_org_features]\n\n        # Gather info about new features\n        out &lt;- understand_randilr(\n            ghl = ghl_mat,\n            org_feature_names = org_feature_names,\n            top_k = top_k\n        ) |&gt;\n            mutate(iter = i)\n\n        results &lt;- results |&gt;\n            bind_rows(out)\n    }\n    return(results)\n}\n\n\nIn the below analysis the following scenario is considered:\n\ninput data has \\(20\\) covariates,\nanalyzed density of skew-symmetric matrix : default density (very sparse skew-symmetric matrix) and \\(\\delta \\in (0.01, 0.02, \\dots, 0.1, 0.2, 0.3, \\dots, 0.9)\\),\nfor each density level of a skew-symmetric matrix, \\(100\\) independent GHL matrices are generated,\nfor a given GHL matrix, the proportion of times when a given original feature contributes to the numerator vs. denominator along with the top \\(5\\) contributors are analyzed.\n\n\n2.1 Contribution to numerator vs denominator\nFor every original feature, count how often it appears in a numerator versus a denominator across all new ILR coordinates (this is, as shown above, determined by the GHL-matrix coefficients). The bars represent the average number of occurrences per original feature over the \\(100\\) simulations.\n\n\nCode\norg_features &lt;- 20\ntop_k &lt;- 5\nn_iters &lt;- 100\nseed_start &lt;- 567\n\nresults &lt;- tibble(\n    density = c(NA_real_, seq(0.01, 0.09, by = 0.01), seq(0.1, 0.9, by = 0.1))\n) |&gt;\n    mutate(\n        ghl_analysis = map(density, ~ density_impact(\n            seed_start = seed_start,\n            n_org_features = org_features,\n            density = .x,\n            top_k = top_k,\n            n_iters = n_iters\n        ))\n    ) |&gt;\n    unnest(ghl_analysis)\n\n# We repeat GHL simulation with a given density of skew-symmetric matrix n_iters times\n# For a given density, on average, how many times is the original feature_k selected into numerator vs denominator\n# Max number of occurrence in numerator/ denominator: (n_org_features - 1) * n_iters\n\ndata_plt1 &lt;- results |&gt;\n    select(density, iter, column, numerator) |&gt;\n    unnest(numerator) |&gt;\n    rename(feature = numerator) |&gt;\n    count(density, feature, name = \"numerator\") |&gt;\n    mutate(numerator = numerator / n_iters) |&gt;\n    left_join(\n        results |&gt;\n            select(density, iter, column, denominator) |&gt;\n            unnest(denominator) |&gt;\n            rename(feature = denominator) |&gt;\n            count(density, feature, name = \"denominator\") |&gt;\n            mutate(denominator = denominator / n_iters)\n    ) |&gt;\n    pivot_longer(cols = c(denominator, numerator), names_to = \"part\", values_to = \"value\") |&gt;\n    mutate(\n        feature = str_remove(feature, \"org_\"),\n        feature = fct_reorder(feature, parse_number(feature)),\n        density = if_else(is.na(density), \"Default\", as.character(density)),\n        density = factor(density,\n            levels = c(\"Default\", sort(as.numeric(setdiff(unique(density), \"Default\"))))\n        ),\n        part = str_to_title(part)\n    )\n\ndata_plt1 |&gt;\n    filter(density %in% c(\"Default\", seq(0.01, 0.09, by = 0.01))) |&gt;\n    ggplot(aes(x = feature, y = value, fill = part)) +\n    geom_bar(position = \"dodge\", stat = \"identity\") +\n    facet_wrap(~density, ncol = 3) +\n    theme_bw() +\n    labs(\n        x = \"Original feature\",\n        y = paste(\"Average occurance across\", n_iters, \"GHL simulations\"),\n        title = \"Contributions of Original Features to Numerator and Denominator in Random ILR Coordinates\",\n        subtitle = paste(\"Aggregated over\", n_iters, \"GHL simulations, panels split by GHL density\")\n    ) +\n    theme(\n        legend.position = \"bottom\",\n        legend.title = element_blank(),\n        plot.title = element_text(size = 16),\n        plot.subtitle = element_text(size = 14),\n        axis.title.x = element_text(size = 14),\n        axis.title.y = element_text(size = 14),\n        axis.text.x = element_text(size = 12, angle = 90),\n        axis.text.y = element_text(size = 12),\n        legend.text = element_text(size = 12)\n    )\n\n\n\n\n\n\n\n\n\nCode\ndata_plt1 |&gt;\n    filter(density %in% c(\"Default\", seq(0.1, 0.9, by = 0.1))) |&gt;\n    ggplot(aes(x = feature, y = value, fill = part)) +\n    geom_bar(position = \"dodge\", stat = \"identity\") +\n    facet_wrap(~density, ncol = 3) +\n    theme_bw() +\n    # scale_y_continuous(breaks = scales::breaks_width(10), minor_breaks = NULL) +\n    labs(\n        x = \"Original feature\",\n        y = paste(\"Average occurance across\", n_iters, \"GHL simulations\"),\n        title = \"Contributions of Original Features to Numerator and Denominator in Random ILR Coordinates\",\n        subtitle = paste(\"Aggregated over\", n_iters, \"GHL simulations, panels split by GHL density\")\n    ) +\n    theme(\n        legend.position = \"bottom\",\n        legend.title = element_blank(),\n        plot.title = element_text(size = 16),\n        plot.subtitle = element_text(size = 14),\n        axis.title.x = element_text(size = 14),\n        axis.title.y = element_text(size = 14),\n        axis.text.x = element_text(size = 12, angle = 90),\n        axis.text.y = element_text(size = 12),\n        legend.text = element_text(size = 12)\n    )\n\n\n\n\n\n\n\n\n\n\n\n2.2 Top 5 contributors\nFor a selected density of the skew-symmetric matrix used to generate the GHL matrix, the plot below displays the expected number of random ILR coordinates in which a given original feature ranks among the five most influential features, i.e., where it has one of the five largest absolute coefficients in the corresponding column of the GHL matrix.\n\n\nCode\ndata_plt2 &lt;- results |&gt;\n    select(iter, column, density, top_contribution) |&gt;\n    unnest(top_contribution) |&gt;\n    count(density, feature, name = \"times_top_k\") |&gt;\n    mutate(\n        times_top_k = times_top_k / n_iters,\n        density = if_else(is.na(density), \"Default\", as.character(density)),\n        density = factor(density,\n            levels = c(\"Default\", sort(as.numeric(setdiff(unique(density), \"Default\"))))\n        ),\n        feature = str_remove(feature, \"org_\"),\n        feature = fct_reorder(feature, parse_number(feature))\n    )\n\ndata_plt2 |&gt;\n    filter(density %in% c(\"Default\", seq(0.01, 0.09, by = 0.01))) |&gt;\n    ggplot(aes(x = feature, y = times_top_k)) +\n    geom_point() +\n    facet_wrap(~density, ncol = 3) +\n    theme_bw() +\n    labs(\n        x = \"Original feature\",\n        y = paste(\"Average number across\", n_iters, \"GHL simulations\"),\n        title = paste(\"Mean Number of ILR Coordinates in Which a Feature Ranks Top\", top_k, \"Contributor\"),\n        subtitle = paste(\"Aggregated over\", n_iters, \"GHL simulations, panels split by GHL density\")\n    ) +\n    theme(\n        legend.position = \"bottom\",\n        legend.title = element_blank(),\n        plot.title = element_text(size = 16),\n        plot.subtitle = element_text(size = 14),\n        axis.title.x = element_text(size = 14),\n        axis.title.y = element_text(size = 14),\n        axis.text.x = element_text(size = 12, angle = 90),\n        axis.text.y = element_text(size = 12),\n        legend.text = element_text(size = 12)\n    )\n\n\n\n\n\n\n\n\n\nCode\ndata_plt2 |&gt;\n    filter(density %in% c(\"Default\", seq(0.1, 0.9, by = 0.1))) |&gt;\n    ggplot(aes(x = feature, y = times_top_k)) +\n    geom_point() +\n    facet_wrap(~density, ncol = 3) +\n    theme_bw() +\n    labs(\n        x = \"Original feature\",\n        y = paste(\"Average number across\", n_iters, \"GHL simulations\"),\n        title = paste(\"Mean Number of ILR Coordinates in Which a Feature Ranks Top\", top_k, \"Contributor\"),\n        subtitle = paste(\"Aggregated over\", n_iters, \"GHL simulations, panels split by GHL density\")\n    ) +\n    theme(\n        legend.position = \"bottom\",\n        legend.title = element_blank(),\n        plot.title = element_text(size = 16),\n        plot.subtitle = element_text(size = 14),\n        axis.title.x = element_text(size = 14),\n        axis.title.y = element_text(size = 14),\n        axis.text.x = element_text(size = 12, angle = 90),\n        axis.text.y = element_text(size = 12),\n        legend.text = element_text(size = 12)\n    )"
  }
]